{% extends '_base.html' %}
{% load crispy_forms_tags %}
{% load static %}

{% block title %}Log in{% endblock %}

{% block main %}
<div class="card border-primary m-auto mb-3" style="max-width: 30rem">
  <div class="card-header text-center">Log in</div>
  <div class="card-body">
    <form method="post" class="m-auto">
      {% csrf_token %}
      {{ form|crispy }}

      <button class="form-control btn btn-primary mt-3">LOG IN</button>
    </form>
  </div>
  <div class="card-footer">
    <p>
      Need an account? <a href="{% url 'account_signup' %}">Register</a>.<br>
      Lost your password? <a href="{% url 'account_reset_password' %}">Reset it</a>.
    </p>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function () {
  const passwordInput = document.querySelector('input[type="password"]');
  if (passwordInput) {
    const wrapper = document.createElement('div');
    wrapper.style.position = 'relative';

    const eyeIcon = document.createElement('i');
    eyeIcon.classList.add('fa', 'fa-eye', 'toggle-password');
    eyeIcon.style.position = 'absolute';
    eyeIcon.style.right = '10px';
    eyeIcon.style.top = '50%';
    eyeIcon.style.transform = 'translateY(-50%)';
    eyeIcon.style.cursor = 'pointer';

    passwordInput.parentNode.insertBefore(wrapper, passwordInput);
    wrapper.appendChild(passwordInput);
    wrapper.appendChild(eyeIcon);

    eyeIcon.addEventListener('click', function () {
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        eyeIcon.classList.remove('fa-eye');
        eyeIcon.classList.add('fa-eye-slash');
      } else {
        passwordInput.type = 'password';
        eyeIcon.classList.remove('fa-eye-slash');
        eyeIcon.classList.add('fa-eye');
      }
    });
  }
});
</script>
{% endblock %}
