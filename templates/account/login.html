{% extends '_base.html' %}
{% load crispy_forms_tags %}
{% load static %}

{% block title %}Log in{% endblock %}

{% block main %}
<div class="card border-primary m-auto mb-3" style="max-width: 30rem">
  <div class="card-header text-center">Log in</div>
  <div class="card-body">
    <form method="post" class="m-auto">
      {% csrf_token %}
      {{ form|crispy }}
      <button type="submit" class="form-control btn btn-primary mt-3">LOG IN</button>
    </form>
  </div>
  <div class="card-footer">
    <p>
      Need an account? <a href="{% url 'account_signup' %}">Register</a>.<br>
      Lost your password? <a href="{% url 'account_reset_password' %}">Reset it</a>.
    </p>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function () {
  const userPassword = document.querySelector('input[type="password"]');
  if (userPassword) {
    const storage = document.createElement('div');
    storage.style.position = 'relative';

    const viewableEye = document.createElement('i');
    viewableEye.classList.add('fa', 'fa-eye', 'toggle-password');
    viewableEye.style.position = 'absolute';
    viewableEye.style.right = '10px';
    viewableEye.style.top = '50%';
    viewableEye.style.transform = 'translateY(-50%)';

    userPassword.parentNode.insertBefore(storage,  userPassword);
    storage.appendChild(userPassword);
    storage.appendChild(viewableEye);

    storage.addEventListener('click', function () {
      if (userPassword === 'password') {
        userPassword.type = 'text';
        viewableEye.classList.remove('fa-eye');
        viewableEye.classList.add('fa-eye-slash');
      } else {
        userPassword.type = 'password';
        viewableEye.classList.remove('fa-eye-slash');
        viewableEye.classList.add('fa-eye');
      }
    });
  }
});
</script>
{% endblock %}
